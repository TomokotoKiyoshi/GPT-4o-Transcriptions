# 实时日语字幕转写系统（附带关键词功能）

## 🧩 简介

本程序是一款基于 GPT-4o-transcribe API 的**多语种实时语音转写与翻译系统**，具有美观现代的图形界面。用户只需连接麦克风并点击“Start Recording”，即可实时获取日语（或其他语言）语音的文字版本，支持翻译为英语、中文等多种语言，并通过浮动字幕窗口进行即时展示。

适用于会议记录、语言学习、字幕辅助等场景。

---

## 🚀 使用方法

### 1. 准备工作

- 确保文件夹中存在两个文件：
  
  - `RealTime_Jp2txt.exe`：已打包好的可执行程序: **在右侧的`Releases`里下载**
  
  - `API_Key.txt`：存放你自己的 OpenAI API Key（GPT-4o 版本支持）

### 2. 配置 API Key

- 在与 `RealTime_Jp2txt.exe` 同级的目录中的文件 `API_Key.txt`，中输入从OpenAI网站获取的一行有效的 API Key，形如：
  
  ```
  sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
  ```

> ⚠️ **请勿将该文件上传至公共仓库或与他人共享！**

### 3. 启动程序

- 双击 `RealTime_Jp2txt.exe` 启动程序。

- 程序启动后将出现图形界面，无需任何命令行操作。

### 4. 界面操作说明

- **关键词输入框**：填写当前语音主题关键词（可选），用于提高模型理解上下文的能力。

- **转写语言选择**：下拉框提供多种选项，包括：
  
  - `ja – 日本語 (Japanese)`
  
  - `en – English`
  
  - `zh – 中文 (Chinese)`
  
  - `ko – 한국어 (Korean)`
  
  - `es – Español`
  
  - `fr – Français`
  
  - `de – Deutsch`
  
  - `ru – Русский`
  
  - `auto – 自動検出 (Auto-detect)`
  
  - 选择 "auto" 时由模型自动检测语言；选择其他语言时将对应语言代码传给 API 强制指定。

- **🎙️ 开始录音**：点击后程序开始采集麦克风音频，每段 4 秒（含 0.8 秒重叠）上传至 GPT-4o Transcribe API 并实时显示文字结果。

- **⏹️ 停止录音**：停止当前录音与转写，已获取字幕保留，可随时重新开始。

- **🖥️ 浮动字幕**：点击可在屏幕底部弹出一个半透明的无边框窗口（悬浮窗），实时显示最近两条无时间戳字幕，支持拖动与缩放。

- **音频电平进度条**：界面中显示当前音频输入强度，实时更新。

- **字幕显示区域**：带滚动条的文本框，自动追加 `[HH:MM:SS] 文字内容` 格式的字幕，自动滚动到底部。

### 5. 关闭程序

- 点击主窗口右上角的关闭按钮即可退出。

- 若开启了悬浮窗，建议先关闭浮窗，再关闭主界面。程序会自动终止线程并释放麦克风资源。

---

## 🧠 功能概览

### ✅ 实时音频采集与分段转写

- 使用 PyAudio 实时采集麦克风音频，按“4 秒 + 0.8 秒重叠”切分为片段发送至 GPT-4o-transcribe；

- 重叠部分帮助上下文衔接，提升连续性和准确性。

### ✅ 关键词上下文提示

- 用户填写的关键词将在首次请求中以 Prompt 形式提供给模型，用于设定语境；

- 后续请求自动拼接前几条结果作为上下文，确保语义连贯。

### ✅ 多语种支持

- 支持 `ja – 日语`、`en – 英语`、`zh – 中文`、`ko – 韩语`、`es – 西班牙语`、`fr – 法语`、`de – 德语`、`ru – 俄语` 及 `auto – 自动检测`；

- 可指定语言代码或交由模型自动识别。

### ✅ 可视化图形界面

- **主窗口**：
  
  - 提供关键词输入、语言选择、录音控制等按钮；
  
  - 显示音频电平、调试信息和实时字幕；

- **悬浮字幕窗口**：
  
  - 无边框、半透明、可拖动和缩放；
  
  - 支持字体大小调整（A-/A+），最多显示最近两句字幕；
  
  - 适合在其他应用窗口上层持续查看。

### ✅ 多线程异步处理

- **音频线程**：处理音频输入和切片；

- **转写线程**：发送音频并调用转写 API；

- **主线程**：仅处理 GUI 和字幕刷新，不卡顿、不卡界面；

- 保证系统响应实时、稳定、流畅。

---

## 📂 配置文件说明

在`Transcription`文件夹下有两个文件:

| 文件名                   | 用途说明                    |
| --------------------- | ----------------------- |
| `RealTime_Jp2txt.exe` | 主程序，双击运行（无需安装）          |
| `API_Key.txt`         | 存放 OpenAI API Key 的文本文件 |

python源码在`Pycode`文件夹中

---

📧 如有任何问题，请联系作者：**heu_xuyouyan@outlook.com**
