# リアルタイム日本語字幕転写システム（キーワード入力機能付き）

## 🧩 はじめに

本ソフトウェアは、GPT-4o-transcribe API に基づいた**多言語対応のリアルタイム音声転写・翻訳システム**であり、モダンで美しいグラフィカルユーザーインターフェース（GUI）を備えています。マイクを接続し「Start Recording」をクリックするだけで、日本語（またはその他の言語）の音声が即座に文字化され、英語や中国語などへの翻訳も可能です。取得した字幕は、フローティングウィンドウでリアルタイムに表示されます。

会議記録、語学学習、字幕支援などのシーンに最適です。

---

## 🚀 使用方法

### 1. 準備作業

フォルダ内に次の2つのファイルがあることを確認してください：

- `RealTime_Jp2txt.exe`：実行可能ファイル（インストール不要）

- `API_Key.txt`：OpenAI の API キーを保存するテキストファイル（GPT-4o対応）

### 2. API Key の設定

- `RealTime_Jp2txt.exe` と同じフォルダにある `API_Key.txt` に、OpenAI公式サイトから取得した有効な API キーを1行記入してください。形式は以下のようになります：

```
sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
```

> ⚠️ **このファイルを公開リポジトリにアップロードしたり、他人と共有したりしないでください！**

### 3. プログラムの起動

- `RealTime_Jp2txt.exe` をダブルクリックして実行してください。

- 起動後、GUIが表示され、コマンドライン操作は不要です。

### 4. 画面操作の説明

- **キーワード入力欄**：話している内容に関連するキーワードを入力します（任意）。モデルが文脈を把握しやすくなります。

- **言語選択ドロップダウン**：以下のオプションから選択できます：
  
  - `ja – 日本語`
  
  - `en – English`
  
  - `zh – 中文（中国語）`
  
  - `ko – 한국어（韓国語）`
  
  - `es – Español（スペイン語）`
  
  - `fr – Français（フランス語）`
  
  - `de – Deutsch（ドイツ語）`
  
  - `ru – Русский（ロシア語）`
  
  - `auto – 自動検出`
  
  「auto」を選ぶとモデルが自動的に言語を判定します。その他を選んだ場合はその言語コードがAPIに送信され、強制指定となります。

- **🎙️ 録音開始**：クリックするとマイク音声の収録を開始し、4秒（0.8秒重複）ごとに GPT-4o Transcribe API に送信してリアルタイムに文字表示します。

- **⏹️ 録音停止**：録音と転写を停止します。取得済みの字幕は保持され、いつでも再開可能です。

- **🖥️ フローティング字幕**：画面下部に半透明・枠なしのウィンドウを表示し、最新の2文をリアルタイムに字幕として表示。ドラッグやサイズ変更にも対応しています。

- **音声レベルバー**：現在の音声入力レベルをリアルタイムに表示します。

- **字幕表示エリア**：スクロール付きテキストボックスに `[HH:MM:SS] 文字列` 形式で字幕が追加され、常に最下部へ自動スクロールします。

### 5. プログラムの終了

- メインウィンドウ右上の「×」ボタンをクリックして終了します。

- フローティングウィンドウを開いている場合は、先にそれを閉じてからメイン画面を終了するのが推奨されます。マイクやスレッドは自動的に解放されます。

---

## 🧠 機能概要

### ✅ リアルタイム音声取得と分割転写

- PyAudio によりマイク入力をリアルタイムで取得し、「4秒＋0.8秒重複」で分割して GPT-4o-transcribe に送信。

- 重複部分により文脈のつながりを維持し、連続性と精度を向上。

### ✅ キーワードによる文脈プロンプト

- 最初のリクエスト時、キーワードがプロンプトとしてモデルに与えられ文脈を設定。

- 以降のリクエストでは、過去の発話を自動で文脈に繋ぎ、意味の一貫性を保ちます。

### ✅ 多言語対応

- `ja（日本語）`、`en（英語）`、`zh（中国語）`、`ko（韓国語）`、`es（スペイン語）`、`fr（フランス語）`、`de（ドイツ語）`、`ru（ロシア語）`、`auto（自動検出）` をサポート。

- 言語コードを指定することも、モデルに自動判定させることも可能です。

### ✅ GUI による視覚的な操作

- **メインウィンドウ**：
  
  - キーワード入力、言語選択、録音ボタンなどを提供。
  
  - 音声レベルやデバッグ情報、リアルタイム字幕を表示。

- **フローティング字幕ウィンドウ**：
  
  - 枠なし・半透明・ドラッグ＆リサイズ可能。
  
  - フォントサイズの調整（A-/A+）対応。最新2文を表示。
  
  - 他アプリ上でも常に表示可能。

### ✅ マルチスレッドによる非同期処理

- **音声スレッド**：音声入力と分割処理を担当。

- **転写スレッド**：APIへの送信とレスポンス処理を担当。

- **メインスレッド**：GUI操作と字幕更新のみを処理し、フリーズなし。

- 高速・安定・リアルタイムな応答性を実現。

---

## 📂 ファイル構成

`Transcription` フォルダ内には次の2つのファイルが含まれています：

| ファイル名                 | 説明                            |
| --------------------- | ----------------------------- |
| `RealTime_Jp2txt.exe` | メインプログラム（ダブルクリックで実行、インストール不要） |
| `API_Key.txt`         | OpenAI API キーを保存するテキストファイル    |

Python のソースコードは `Pycode` フォルダ内にあります。
